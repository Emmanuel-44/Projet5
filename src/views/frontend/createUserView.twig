{% extends "layout.twig" %}

{% block nav %}
    <!-- ====== Navbar ====== -->
    <nav class="navbar navbar-expand-lg fixed-top bg-primari">
        <div class="container">
            <!-- Logo -->
            <a class="navbar-brand logo" href="index.html">
                <img src="http://localhost/Projet5/public/assets/images/logo.png" alt="logo">
            </a>
            <!-- // Logo -->
            <!-- Mobile Menu -->
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-expanded="false"><span><i class="fa fa-bars"></i></span></button>
            <!-- Mobile Menu -->
            <div class="collapse navbar-collapse main-menu margin" id="navbarSupportedContent">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" href="http://localhost/Projet5">ACCUEIL</a></li>
                    <li class="nav-item"><a class="nav-link" href="http://localhost/Projet5/blog">BLOG</a></li>
                </ul>
                <ul class="navbar-nav ml-auto">
                    {% if session.user is defined and session.user is not empty %}
                        <li class="nav-item"><img src="http://localhost/Projet5/{{ session.user.imagePath }}" class="avatar-img mt-2 mb-2" alt="Photo de profil"></li>
                        <li class="dropdown nav-link">
                            <button class="btn btn-outline-warning dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Bonjour {{ session.user.username }}</a>
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                <p class="dropdown-item">{{ session.user.contactEmail }}</p>
                                <p class="dropdown-item">Membre depuis le {{ session.user.addingDate | date('d/m/Y') }}</p>
                                <div class="dropdown-divider"></div>
                                {% if 'ADMIN' in session.user.role %}<a class="dropdown-item" href="http://localhost/Projet5/admin">Espace administration</a>{% endif %}
                                <a class="dropdown-item" href="http://localhost/Projet5/logout">Se déconnecter</a> 
                            </div>
                        </li>
                    {% else %}
                        <li class="nav-item"><a class="nav-link" href="http://localhost/Projet5/login">Se connecter</a></li>
                        <li class="nav-item"><a class="nav-link active" href="http://localhost/Projet5/creer-un-compte">Créer un compte</a></li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>
{% endblock %}

{% block image %}
<!-- Page Title -->
<div class="page-title bg-img section-padding bg-overlay" style="background-image: url(public/assets/images/breadcrumb.jpg)">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-6 text-center">
                <h2>Créer un compte</h2>
            </div>
        </div>
    </div>
</div>
<!-- // Page Title -->
{% endblock %}

{% block content %}
<div class="container" style="max-width: 500px; margin-top:80px; margin-bottom:80px;">
    <form class="mt-5" action="" method="post" enctype="multipart/form-data">
    {% if 'username_error' in user.errors %}
    <div class="alert alert-danger" role="alert">
        Ce pseudo existe déjà !
    </div>
    {% endif %}
    {% if 'email_error' in user.errors %}
    <div class="alert alert-danger" role="alert">
        Cette adresse email existe déjà !
    </div>
    {% endif %}
        <label for="username">Pseudo :</label>
        {% if constant('models\\User::INVALID_USERNAME') in user.errors %}
            <div class="alert alert-danger" role="alert">
                Vous devez renseigner votre pseudo !
            </div>
        {% endif %}
        <div class="form-group">
            <input class="form-control" type="text" name="username" value="{{ user.errors is not empty ? user.username }}">
        </div>
        <label for="email">Email :</label>
        {% if constant('models\\User::INVALID_EMAIL') in user.errors %}
            <div class="alert alert-danger" role="alert">
                Vous devez renseigner votre email dans un format valide !
            </div>
        {% endif %}
        <div class="form-group">
            <input class="form-control" type="text" name="email" value="{{ user.errors is not empty ? user.contactEmail }}">
        </div>
        <label for="password">Mot de passe :</label>
        {% if constant('models\\User::INVALID_PASSWORD') in user.errors %}
            <div class="alert alert-danger" role="alert">
                Vous devez renseigner votre mot de passe et le confirmer !
            </div>
        {% endif %}
        <div class="form-group">
            <input class="form-control" type="password" name="password">
        </div>
        <label for="confirm_password">Confirmez votre mot de passe :</label>
        {% if post.confirm_password is empty and post.confirm_password is defined %}
        <div class="alert alert-danger" role="alert">
            Vous devez confirmer votre mot de passe !
        </div>
        {% endif %}
        <div class="form-group">
            <input class="form-control" type="password" name="confirm_password">
        </div>
        <div class="mt-5 row">
            <div class="col-lg-9">
                <label for="image">Sélectionner l'image : <i>(jpg, jpeg, png, gif)</i></label>
                <div class="form-group">
                    <input type="file" name="image" />
                </div>
            </div>
            <div class="col-lg-3">
                <button type="submit" class="btn btn-primary" style="margin-top: 15px">Ajouter</button>
            </div>
        </div>
    </form>
</div>
{% endblock %}