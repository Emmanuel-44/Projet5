{% extends "layout.twig" %}

{% block nav %}
    <!-- ====== Navbar ====== -->
    <nav class="navbar navbar-expand-lg fixed-top bg-primari">
        <div class="container">
            <!-- Logo -->
            <a class="navbar-brand logo" href="index.html">
                <img src="http://localhost/Projet5/public/assets/images/logo.png" alt="logo">
            </a>
            <!-- // Logo -->
            <!-- Mobile Menu -->
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-expanded="false"><span><i class="fa fa-bars"></i></span></button>
            <!-- Mobile Menu -->
            <div class="collapse navbar-collapse main-menu margin" id="navbarSupportedContent">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" href="http://localhost/Projet5">ACCUEIL</a></li>
                    <li class="nav-item"><a class="nav-link" href="http://localhost/Projet5/blog">BLOG</a></li>
                </ul>
                <ul class="navbar-nav ml-auto">
                    {% if session.user is defined and session.user is not empty %}
                        <li class="nav-item"><img src="http://localhost/Projet5/{{ session.user.imagePath }}" class="avatar-img mt-2 mb-2" alt="Photo de profil"></li>
                        <li class="dropdown nav-link">
                            <button class="btn btn-outline-warning dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Bonjour {{ session.user.username }}</a>
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                <p class="dropdown-item">{{ session.user.contactEmail }}</p>
                                <p class="dropdown-item">Membre depuis le {{ session.user.addingDate | date('d/m/Y') }}</p>
                                <div class="dropdown-divider"></div>
                                {% if 'ADMIN' in session.user.role %}<a class="dropdown-item" href="http://localhost/Projet5/admin">Espace administration</a>{% endif %}
                                <a class="dropdown-item" href="http://localhost/Projet5/logout">Se déconnecter</a> 
                            </div>
                        </li>
                    {% else %}
                        <li class="nav-item"><a class="nav-link" href="http://localhost/Projet5/login">Se connecter</a></li>
                        <li class="nav-item"><a class="nav-link" href="http://localhost/Projet5/creer-un-compte">Créer un compte</a></li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>
{% endblock %}

{% block image %}
    <div class="page-title bg-img section-padding bg-overlay" style="background-image: url(http://localhost/Projet5/public/assets/images/admin.jpg)">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-6 text-center">
                    <h2><small>Espace Administration</small></h2>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block content %}
    <div class="container" style="max-width: 800px; margin-top:80px; margin-bottom:80px;">
        <div class="row">
            <div class="col-lg-10"><h2>Modifier un article</h2></div>
            <div class="col-lg-2 pt-3"><a href="http://localhost/Projet5/admin">Retour</a></div>
        </div>
        {% if post is defined and post.errors is empty %}
            <div class="alert alert-success" role="alert">
                Votre article a été modifié !
            </div>
        {% endif %}

        <form class="mt-5" action="" method="post" enctype="multipart/form-data">
        <input type="hidden" name="token" id="token" value="{{ session.token }}">
            <label for="username">Auteur :</label>
            <div class="form-group">
                <input class="form-control" type="text" name="username" readonly value="{{ post.author }}">
            </div>
            <label for="title">Titre :</label>
                {% if constant('models\\Post::INVALID_TITLE') in post.errors %}
                    <div class="alert alert-danger" role="alert">
                        Vous devez ajouter un titre !
                    </div>
                {% endif %}
            <div class="form-group">
                <input class="form-control" type="text" name="title" value="{{ post.title }}">
            </div>
            <label for="teaser">Chapô :</label>
                {% if constant('models\\Post::INVALID_TEASER') in post.errors %}
                    <div class="alert alert-danger" role="alert">
                        Ce champ est obligatoire !
                    </div>
                {% endif %}
            <div class="form-group">
                <textarea class="form-control" name="teaser">{{ post.teaser }}</textarea>
            </div>
            <label for="content">Contenu de l'article :</label>
                {% if constant('models\\Post::INVALID_CONTENT') in post.errors %}
                    <div class="alert alert-danger" role="alert">
                        Votre article n'a pas de contenu !
                    </div>
                {% endif %}
            <div class="form-group">
                <textarea class="form-control" name="content" rows="10">{{ post.content }}</textarea>
            </div>
            <div class="mt-5 row">
                <div class="col-lg-10">
                    <label for="image">Sélectionner l'image : <i>(jpg, jpeg, png, gif)</i></label>
                    <div class="form-group">
                        <input type="file" name="image" />
                    </div>
                </div>
                <div class="col-lg-2">
                    <button type="submit" class="btn btn-primary" style="margin-top: 15px">Modifier</button>
                </div>
            </div>
        </form>
    </div>
{% endblock %}